\section{Partial\-Char\-CDI Class Reference}
\label{classPartialCharCDI}\index{PartialCharCDI@{PartialCharCDI}}
Inheritance diagram for Partial\-Char\-CDI::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classPartialCharCDI}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\bf{Partial\-Char\-CDI} (\bf{Complex\_\-2D} \&initial\_\-guess, double z\_\-dist=2, double beam\_\-energy=1.239841e-6, double pixel\_\-x\_\-size=1, double pixel\_\-y\_\-size=1, unsigned int n\_\-best=0)\label{classPartialCharCDI_044da48b8639364453d5f8d51c8f58ee}

\item 
void \bf{set\_\-initial\_\-coherence\_\-guess} (double lx\_\-, double ly\_\-)
\item 
void \bf{set\_\-initial\_\-coherence\_\-guess\_\-in\_\-m} (double lx\_\-, double ly\_\-)
\item 
virtual void \bf{initialise\_\-estimate} (int seed=0)
\item 
void \bf{set\_\-intensity} (const \bf{Double\_\-2D} \&detector\_\-intensity)
\item 
void \bf{set\_\-minima\_\-search\_\-bounds\_\-coefficient} (double coef)
\item 
void \bf{set\_\-minima\_\-search\_\-tolerance} (double tol)
\item 
void \bf{set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m} (double tol)
\item 
void \bf{set\_\-minima\_\-moving\_\-average\_\-weight} (double w)
\item 
void \bf{set\_\-minima\_\-recalculation\_\-interval} (unsigned int ival)
\item 
double \bf{get\_\-x\_\-coherence\_\-length} ()
\item 
double \bf{get\_\-y\_\-coherence\_\-length} ()
\item 
double \bf{get\_\-x\_\-coherence\_\-length\_\-in\_\-pixels} ()
\item 
double \bf{get\_\-y\_\-coherence\_\-length\_\-in\_\-pixels} ()
\item 
virtual void \bf{propagate\_\-to\_\-detector} (\bf{Complex\_\-2D} \&c)
\item 
virtual void \bf{propagate\_\-from\_\-detector} (\bf{Complex\_\-2D} \&c)
\item 
void \bf{scale\_\-intensity} (\bf{Complex\_\-2D} \&c)
\item 
virtual int \bf{iterate} ()
\item 
\bf{Complex\_\-2D} $\ast$ \bf{get\_\-best\_\-result} (double \&error, int index=0)
\item 
void \bf{set\_\-support} (const \bf{Double\_\-2D} \&object\_\-support, bool soften=false)
\item 
void \bf{set\_\-beam\_\-stop} (const \bf{Double\_\-2D} \&beam\_\-stop\_\-region)
\item 
void \bf{set\_\-relaxation\_\-parameter} (double relaxation\_\-parameter)
\item 
int \bf{get\_\-size\_\-x} ()
\item 
int \bf{get\_\-size\_\-y} ()
\item 
const \bf{Complex\_\-2D} \& \bf{get\_\-exit\_\-surface\_\-wave} ()\label{classBaseCDI_8c6add0215552640496dd143c037e32d}

\item 
void \bf{set\_\-exit\_\-surface\_\-wave} (\bf{Complex\_\-2D} \&esw)\label{classBaseCDI_9b9683ab74a9759b7a449264d0c530f4}

\item 
void \bf{set\_\-algorithm} (int alg)
\item 
void \bf{set\_\-custom\_\-algorithm} (double m1, double m2, double m3, double m4, double m5, double m6, double m7, double m8, double m9, double m10)
\item 
void \bf{print\_\-algorithm} ()
\item 
double \bf{get\_\-error} ()
\item 
virtual void \bf{apply\_\-shrinkwrap} (double gauss\_\-width=1.5, double threshold=0.1)
\item 
const \bf{Double\_\-2D} \& \bf{get\_\-support} ()
\item 
virtual void \bf{apply\_\-support} (\bf{Complex\_\-2D} \&c)
\item 
virtual void \bf{project\_\-intensity} (\bf{Complex\_\-2D} \&c)
\item 
void \bf{set\_\-fftw\_\-type} (int type)
\item 
virtual void \bf{set\_\-complex\_\-constraint} (\bf{Transmission\-Constraint} \&trans\_\-constraint)
\item 
void \bf{reset\_\-best} ()\label{classBaseCDI_575a9bdc868c230c734c68bb5ffa657b}

\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
static int \bf{get\-Alg\-From\-Name} (std::string algorithm\_\-name)
\end{CompactItemize}
\subsection*{Protected Member Functions}
\begin{CompactItemize}
\item 
void \bf{apply\_\-threshold} (\bf{Double\_\-2D} \&array, double threshold)
\item 
void \bf{convolve} (\bf{Double\_\-2D} \&array, double gauss\_\-width, int pixel\_\-cut\_\-off=4)
\item 
void \bf{support\_\-constraint} (\bf{Complex\_\-2D} \&c)\label{classBaseCDI_3bd94fddd7474977f7a69600f276aa44}

\item 
void \bf{reallocate\_\-temp\_\-complex\_\-memory} ()\label{classBaseCDI_a5d53d9a28a4edd3e320fbe29d17782f}

\item 
void \bf{update\_\-n\_\-best} ()\label{classBaseCDI_77ca159159d8fc644d987c629a64f499}

\end{CompactItemize}
\subsection*{Static Protected Member Functions}
\begin{CompactItemize}
\item 
static std::map$<$ std::string, int $>$ $\ast$ \bf{set\_\-up\_\-algorithm\_\-name\_\-map} ()
\end{CompactItemize}
\subsection*{Protected Attributes}
\begin{CompactItemize}
\item 
double \bf{lx}
\item 
double \bf{ly}\label{classPartialCharCDI_f175fed65f0060b496fdf0a1e454c97b}

\item 
double \bf{z}\label{classPartialCharCDI_8a42d4260b43bb156e46eac8933068ee}

\item 
double \bf{wavelength}\label{classPartialCharCDI_39e6fd4eacf9e7c9955663f3c86de5f0}

\item 
double \bf{px\_\-x\_\-size}\label{classPartialCharCDI_737e0814388e9db533aca8b4e19e343c}

\item 
double \bf{px\_\-y\_\-size}\label{classPartialCharCDI_a2a224de325b39e4873159c137bad16e}

\item 
\bf{Double\_\-2D} \bf{measured\_\-intensity}\label{classPartialCharCDI_82eff3dff6519bb41b34c81e4ed7c0a6}

\item 
\bf{Complex\_\-2D} \& \bf{complex}
\item 
int \bf{nx}
\item 
int \bf{ny}
\item 
\bf{Complex\_\-2D} $\ast$ \bf{temp\_\-complex\_\-PFS}
\item 
\bf{Complex\_\-2D} $\ast$ \bf{temp\_\-complex\_\-PF}\label{classBaseCDI_fdf6f4568ed3475dc94e49887327c2ff}

\item 
\bf{Complex\_\-2D} $\ast$ \bf{temp\_\-complex\_\-PS}\label{classBaseCDI_fc480ef7ebfb0971c0ecfa1a3a2f9395}

\item 
\bf{Complex\_\-2D} $\ast$ \bf{temp\_\-complex\_\-PSF}\label{classBaseCDI_0db0cbd1918b540113b56bfe459fb37a}

\item 
double \bf{beta}
\item 
\bf{Double\_\-2D} \bf{support}
\item 
\bf{Double\_\-2D} \bf{intensity\_\-sqrt}
\item 
\bf{Double\_\-2D} $\ast$ \bf{beam\_\-stop}
\item 
int \bf{algorithm}
\item 
double \bf{algorithm\_\-structure} [NTERMS]
\item 
double \bf{current\_\-error}
\item 
int \bf{n\_\-best}
\item 
\bf{Complex\_\-2D} $\ast$$\ast$ \bf{best\_\-array}
\item 
double $\ast$ \bf{best\_\-error\_\-array}
\item 
\bf{Transmission\-Constraint} $\ast$ \bf{transmission\_\-constraint}
\end{CompactItemize}
\subsection*{Static Protected Attributes}
\begin{CompactItemize}
\item 
static std::map$<$ std::string, int $>$ $\ast$ \bf{alg\-Name\-Map} = Base\-CDI::set\_\-up\_\-algorithm\_\-name\_\-map()
\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
\bf{Double\_\-2D} \bf{get\_\-convoluted\_\-intensity\_\-estimate} (\bf{Double\_\-2D} const \&estimated\_\-intensity, \bf{Double\_\-2D} const \&\bf{measured\_\-intensity})
\end{CompactItemize}
\subsection*{Static Private Member Functions}
\begin{CompactItemize}
\item 
static double \bf{convoluted\_\-estimate\_\-error} (\bf{Double\_\-2D} const \&\bf{measured\_\-intensity}, \bf{Double\_\-2D} const \&estimated\_\-intensity, double \bf{lx}, double \bf{ly})
\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
unsigned int \bf{iteration}\label{classPartialCharCDI_42c6e656a57ac8cbb639ef755a2c6bfe}

\item 
unsigned int \bf{minima\_\-recalculation\_\-interval}\label{classPartialCharCDI_2287b59be431e2164c64a5c8ee2b4244}

\item 
double \bf{minima\_\-search\_\-bounds\_\-coefficient}\label{classPartialCharCDI_c46ee7605e957fcf67ff9efdb598b3f8}

\item 
double \bf{minima\_\-search\_\-tolerance}\label{classPartialCharCDI_3e712eb3dd885ef8978117dad511c351}

\item 
double \bf{minima\_\-moving\_\-average\_\-weight}\label{classPartialCharCDI_3f5f3683a8d33d97e8608a94568d952e}

\end{CompactItemize}


\subsection{Detailed Description}




Definition at line 32 of file Partial\-Char\-CDI.h.

\subsection{Member Function Documentation}
\index{PartialCharCDI@{Partial\-Char\-CDI}!set_initial_coherence_guess@{set\_\-initial\_\-coherence\_\-guess}}
\index{set_initial_coherence_guess@{set\_\-initial\_\-coherence\_\-guess}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-initial\_\-coherence\_\-guess (double {\em lx\_\-}, double {\em ly\_\-})}\label{classPartialCharCDI_90d0d2ab53ccd92cbd439b2cf4a8abc0}


Default: 0.7, 0.7

Set an initial guess for the beam coherence lengths (in pixels).

Note that while bad values for this guess won't stop convergence, they can slow it down significantly. 

Definition at line 47 of file Partial\-Char\-CDI.c++.

References lx, and ly.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_initial_coherence_guess_in_m@{set\_\-initial\_\-coherence\_\-guess\_\-in\_\-m}}
\index{set_initial_coherence_guess_in_m@{set\_\-initial\_\-coherence\_\-guess\_\-in\_\-m}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-initial\_\-coherence\_\-guess\_\-in\_\-m (double {\em lx\_\-}, double {\em ly\_\-})}\label{classPartialCharCDI_28e050e851a271fe1be2a92dc7cc37fd}


Set an initial guess for the beam coherence lengths in m, measured in the object plane. 

Definition at line 56 of file Partial\-Char\-CDI.c++.

References lx, ly, px\_\-x\_\-size, px\_\-y\_\-size, wavelength, and z.\index{PartialCharCDI@{Partial\-Char\-CDI}!initialise_estimate@{initialise\_\-estimate}}
\index{initialise_estimate@{initialise\_\-estimate}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void initialise\_\-estimate (int {\em seed} = {\tt 0})\hspace{0.3cm}{\tt  [virtual]}}\label{classPartialCharCDI_9f865b7d630be93ac2146b956197f224}


Set the values in the \doxyref{Complex\_\-2D}{p.}{classComplex__2D} to an initial estimate. For \doxyref{Base\-CDI}{p.}{classBaseCDI}, this is set to random numbers inside the support for both the real and complex components, and zero outside the support.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em seed}]The seed for the random number generator. By default this is 0. \end{description}
\end{Desc}


Implements \bf{Base\-CDI} \doxyref{p.}{classBaseCDI_367600727763c6b5aef7ff6d7016b3fa}.

Definition at line 160 of file Partial\-Char\-CDI.c++.

References Base\-CDI::complex, IMAG, Base\-CDI::intensity\_\-sqrt, Base\-CDI::nx, Base\-CDI::ny, REAL, Complex\_\-2D::set\_\-value(), and Base\-CDI::support.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_intensity@{set\_\-intensity}}
\index{set_intensity@{set\_\-intensity}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-intensity (const \bf{Double\_\-2D} \& {\em detector\_\-intensity})}\label{classPartialCharCDI_2abd04ba9abea4c339355d80cc38e754}


Set the detector diffraction image (i.e. the square of the amplitude of the wavefield at the detector).

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em detector\_\-intensity}]The intensity at the detector \end{description}
\end{Desc}


Reimplemented from \bf{Base\-CDI} \doxyref{p.}{classBaseCDI_2abd04ba9abea4c339355d80cc38e754}.

Definition at line 185 of file Partial\-Char\-CDI.c++.

References Base\-CDI::intensity\_\-sqrt, measured\_\-intensity, Base\-CDI::nx, and Base\-CDI::ny.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_minima_search_bounds_coefficient@{set\_\-minima\_\-search\_\-bounds\_\-coefficient}}
\index{set_minima_search_bounds_coefficient@{set\_\-minima\_\-search\_\-bounds\_\-coefficient}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-minima\_\-search\_\-bounds\_\-coefficient (double {\em coef})}\label{classPartialCharCDI_45a0ef6df8cdc26d763c352da64ad1cc}


Default = 2.5

Set the factor that will be used to determine the search region. Search will go from 1/coef to coef times the current estimate.

If you are very unsure of your initial guess of lx and ly (beam coherence lengths) or if you are just using the default guess of 0.7 pixels in each direction, then you might want to increase this to 3. 

Definition at line 71 of file Partial\-Char\-CDI.c++.

References minima\_\-search\_\-bounds\_\-coefficient.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_minima_search_tolerance@{set\_\-minima\_\-search\_\-tolerance}}
\index{set_minima_search_tolerance@{set\_\-minima\_\-search\_\-tolerance}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-minima\_\-search\_\-tolerance (double {\em tol})}\label{classPartialCharCDI_b8939731231639bf7f48ebbea4e803d8}


Default = 0.1

The the tolerance of the lx/ly minima search in pixels (search will terminate when uncertainty is less than this value). 

Definition at line 80 of file Partial\-Char\-CDI.c++.

References minima\_\-search\_\-tolerance.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_minima_search_tolerance_in_m@{set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m}}
\index{set_minima_search_tolerance_in_m@{set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m (double {\em tol})}\label{classPartialCharCDI_7a9c117d594c79a44ed152601441ab22}


The the tolerance of the lx/ly minima search in object-plane-meters (search will terminate when uncertainty is less than this value). 

Definition at line 88 of file Partial\-Char\-CDI.c++.

References minima\_\-search\_\-tolerance, px\_\-x\_\-size, px\_\-y\_\-size, wavelength, and z.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_minima_moving_average_weight@{set\_\-minima\_\-moving\_\-average\_\-weight}}
\index{set_minima_moving_average_weight@{set\_\-minima\_\-moving\_\-average\_\-weight}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-minima\_\-moving\_\-average\_\-weight (double {\em w})}\label{classPartialCharCDI_b14bf3592bab3506aba371b83b4f7ef8}


Default = 0.01

lx and ly values will be time averaged with the previous estimate (to smooth the slightly-erratic changes from iteration to iteration). w is the weight of the newly calculated value. The current estimate will be weighted at (1-w) to form a new current estimate. This is an exponential moving average.

Setting w to 1.0 will be the same as having no moving average. 

Definition at line 104 of file Partial\-Char\-CDI.c++.

References minima\_\-moving\_\-average\_\-weight.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_minima_recalculation_interval@{set\_\-minima\_\-recalculation\_\-interval}}
\index{set_minima_recalculation_interval@{set\_\-minima\_\-recalculation\_\-interval}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-minima\_\-recalculation\_\-interval (unsigned int {\em ival})}\label{classPartialCharCDI_8ee6c2259ee922e1e82a5a17ccd162f4}


Default = 5

The values of lx and ly will only be updated every ival iterations (since the process is rather slow). There's not much advantage to doing this more frquently than the default of 5 unless there are very few total iterations being calculated. 

Definition at line 115 of file Partial\-Char\-CDI.c++.

References minima\_\-recalculation\_\-interval.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_x_coherence_length@{get\_\-x\_\-coherence\_\-length}}
\index{get_x_coherence_length@{get\_\-x\_\-coherence\_\-length}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double get\_\-x\_\-coherence\_\-length ()}\label{classPartialCharCDI_5af5d352522d5457f478c5128f1b7dfa}


Retrieve the calculated coherence length of the beam (the std. deviation of the fitted gaussian) in the x direction, in meters, in the object plane.

Call this after iterating enough to produce a satisfactory image. This value will only be accurate to within the tolerances set by set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m. 

Definition at line 126 of file Partial\-Char\-CDI.c++.

References lx, px\_\-x\_\-size, wavelength, and z.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_y_coherence_length@{get\_\-y\_\-coherence\_\-length}}
\index{get_y_coherence_length@{get\_\-y\_\-coherence\_\-length}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double get\_\-y\_\-coherence\_\-length ()}\label{classPartialCharCDI_f7a6423eeae4bad174f5a8ff4bcc27bf}


Retrieve the calculated coherence length of the beam (the std. deviation of the fitted gaussian) in the y direction, in meters, in the object plane.

Call this after iterating enough to produce a satisfactory image. This value will only be accurate to within the tolerances set by set\_\-minima\_\-search\_\-tolerance\_\-in\_\-m. 

Definition at line 137 of file Partial\-Char\-CDI.c++.

References ly, px\_\-y\_\-size, wavelength, and z.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_x_coherence_length_in_pixels@{get\_\-x\_\-coherence\_\-length\_\-in\_\-pixels}}
\index{get_x_coherence_length_in_pixels@{get\_\-x\_\-coherence\_\-length\_\-in\_\-pixels}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double get\_\-x\_\-coherence\_\-length\_\-in\_\-pixels ()}\label{classPartialCharCDI_46ea04a1d980308557f21fd913b45b27}


Retrieve the calculated x coherence length of the beam in pixels. This can be useful for interacting simulated data on a pixel-scale. 

Definition at line 145 of file Partial\-Char\-CDI.c++.

References lx.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_y_coherence_length_in_pixels@{get\_\-y\_\-coherence\_\-length\_\-in\_\-pixels}}
\index{get_y_coherence_length_in_pixels@{get\_\-y\_\-coherence\_\-length\_\-in\_\-pixels}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double get\_\-y\_\-coherence\_\-length\_\-in\_\-pixels ()}\label{classPartialCharCDI_b52574cbfbb7fd0c9244d25855086764}


Retrieve the calculated y coherence length of the beam in pixels. This can be useful for interacting simulated data on a pixel-scale. 

Definition at line 154 of file Partial\-Char\-CDI.c++.

References ly.\index{PartialCharCDI@{Partial\-Char\-CDI}!propagate_to_detector@{propagate\_\-to\_\-detector}}
\index{propagate_to_detector@{propagate\_\-to\_\-detector}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void propagate\_\-to\_\-detector (\bf{Complex\_\-2D} \& {\em c})\hspace{0.3cm}{\tt  [virtual]}}\label{classPartialCharCDI_5adde93a2b66b1bf8597fdb2e120c9b7}


Propagate to the sample plane using a fast fourier transform.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em c}]The \doxyref{Complex\_\-2D}{p.}{classComplex__2D} field to propagate \end{description}
\end{Desc}


Implements \bf{Base\-CDI} \doxyref{p.}{classBaseCDI_a8b5944739fc612a5c495804b7587686}.

Definition at line 196 of file Partial\-Char\-CDI.c++.

References Complex\_\-2D::invert(), and Complex\_\-2D::perform\_\-forward\_\-fft().\index{PartialCharCDI@{Partial\-Char\-CDI}!propagate_from_detector@{propagate\_\-from\_\-detector}}
\index{propagate_from_detector@{propagate\_\-from\_\-detector}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void propagate\_\-from\_\-detector (\bf{Complex\_\-2D} \& {\em c})\hspace{0.3cm}{\tt  [virtual]}}\label{classPartialCharCDI_c98ac38c2b63e5f7deba5316e772db9f}


Propagate to the detector plane using a fast fourier transform. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em c}]The \doxyref{Complex\_\-2D}{p.}{classComplex__2D} field to propagate \end{description}
\end{Desc}


Implements \bf{Base\-CDI} \doxyref{p.}{classBaseCDI_1f673f0f756def2e645a5c6dc654803d}.

Definition at line 201 of file Partial\-Char\-CDI.c++.

References Complex\_\-2D::invert(), and Complex\_\-2D::perform\_\-backward\_\-fft().\index{PartialCharCDI@{Partial\-Char\-CDI}!scale_intensity@{scale\_\-intensity}}
\index{scale_intensity@{scale\_\-intensity}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void scale\_\-intensity (\bf{Complex\_\-2D} \& {\em c})\hspace{0.3cm}{\tt  [virtual]}}\label{classPartialCharCDI_8aacc20f278648d3eba9648026d762b8}


The intensity is scaled to match the measured data. The error is updated in this method.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em c}]The complex field to apply the scaling to \end{description}
\end{Desc}


Reimplemented from \bf{Base\-CDI} \doxyref{p.}{classBaseCDI_8aacc20f278648d3eba9648026d762b8}.

Definition at line 209 of file Partial\-Char\-CDI.c++.

References Base\-CDI::beam\_\-stop, Base\-CDI::current\_\-error, Complex\_\-2D::get\_\-2d(), get\_\-convoluted\_\-intensity\_\-estimate(), Complex\_\-2D::get\_\-mag(), Base\-CDI::intensity\_\-sqrt, iteration, lx, ly, MAG\_\-SQ, measured\_\-intensity, minima\_\-recalculation\_\-interval, Base\-CDI::nx, Base\-CDI::ny, and Complex\_\-2D::set\_\-mag().\index{PartialCharCDI@{Partial\-Char\-CDI}!get_convoluted_intensity_estimate@{get\_\-convoluted\_\-intensity\_\-estimate}}
\index{get_convoluted_intensity_estimate@{get\_\-convoluted\_\-intensity\_\-estimate}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Double\_\-2D} get\_\-convoluted\_\-intensity\_\-estimate (\bf{Double\_\-2D} const \& {\em estimated\_\-intensity}, \bf{Double\_\-2D} const \& {\em measured\_\-intensity})\hspace{0.3cm}{\tt  [private]}}\label{classPartialCharCDI_3f770bf54cd342182fea5ff67a912fe4}


Find a gaussian matrix g with standard deviations in x and y that minimise the energy difference between the gaussian-convoluted current estimated intensity and the measured intensity. Returns the convolution of c and g (ie. the gaussian blurred estimate that best matches the measured intensity). This can be thought of as a coherence-corrected estimate.

See: Applied Physics Letters 99 (2011) - 'Simultaneous sample and spatial coherence characterisation using diffractive imaging' [doi: 10.1063/1.3650265] for further details. 

Definition at line 261 of file Partial\-Char\-CDI.c++.

References lx, ly, measured\_\-intensity, minima\_\-moving\_\-average\_\-weight, minima\_\-search\_\-bounds\_\-coefficient, and minima\_\-search\_\-tolerance.\index{PartialCharCDI@{Partial\-Char\-CDI}!convoluted_estimate_error@{convoluted\_\-estimate\_\-error}}
\index{convoluted_estimate_error@{convoluted\_\-estimate\_\-error}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double convoluted\_\-estimate\_\-error (\bf{Double\_\-2D} const \& {\em measured\_\-intensity}, \bf{Double\_\-2D} const \& {\em estimated\_\-intensity}, double {\em lx}, double {\em ly})\hspace{0.3cm}{\tt  [static, private]}}\label{classPartialCharCDI_1117a38cf7948ee9af3b9d86532a2748}


Take the integral over the absolute difference between the measured\_\-intensity and the convolution of estimated\_\-intesity and a gaussian of standard deviations lx and ly in x and y directions respectivley.

This is a measure for how accurate the estimate is given known coherence lengths lx and ly. It is used internally to automatically fit for lx and ly (by minimising its value in lx and ly) every few iterations.

This call is quite expensive. 

Definition at line 288 of file Partial\-Char\-CDI.c++.

References measured\_\-intensity.\index{PartialCharCDI@{Partial\-Char\-CDI}!iterate@{iterate}}
\index{iterate@{iterate}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int iterate ()\hspace{0.3cm}{\tt  [virtual, inherited]}}\label{classBaseCDI_9e3435f91897cd401e77d56919e51da2}


The main method for running the reconstruction! This method transforms the \doxyref{Complex\_\-2D}{p.}{classComplex__2D} given to it according to: \par
$ x_{k+1} = g ( x_{k} ) $ \par
 Where $g()$ depends on the algorithm used. The current error is also updated when this method is called. 

Reimplemented in \bf{Fresnel\-CDI\_\-WF} \doxyref{p.}{classFresnelCDI__WF_9e3435f91897cd401e77d56919e51da2}, \bf{Partial\-CDI} \doxyref{p.}{classPartialCDI_9e3435f91897cd401e77d56919e51da2}, and \bf{Poly\-CDI} \doxyref{p.}{classPolyCDI_9e3435f91897cd401e77d56919e51da2}.

Definition at line 294 of file Base\-CDI.c++.

References Base\-CDI::algorithm, Base\-CDI::algorithm\_\-structure, Base\-CDI::apply\_\-support(), Base\-CDI::complex, Complex\_\-2D::copy(), Complex\_\-2D::get\_\-imag(), Complex\_\-2D::get\_\-real(), Base\-CDI::nx, Base\-CDI::ny, Base\-CDI::project\_\-intensity(), Complex\_\-2D::set\_\-imag(), Complex\_\-2D::set\_\-real(), SUCCESS, Base\-CDI::temp\_\-complex\_\-PF, Base\-CDI::temp\_\-complex\_\-PFS, Base\-CDI::temp\_\-complex\_\-PS, Base\-CDI::temp\_\-complex\_\-PSF, and Base\-CDI::update\_\-n\_\-best().\index{PartialCharCDI@{Partial\-Char\-CDI}!get_best_result@{get\_\-best\_\-result}}
\index{get_best_result@{get\_\-best\_\-result}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Complex\_\-2D} $\ast$ get\_\-best\_\-result (double \& {\em error}, int {\em index} = {\tt 0})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_9ca82195dc0f0adcd79fa391ae3ef821}


While the reconstruction is running this object will store the \char`\"{}n\_\-best\char`\"{} number of best estimates according to the error metric. So, for example, if HIO is used and the error enters and leaves an error minima during reconstruction, the best (ie. lowest error) \doxyref{Complex\_\-2D}{p.}{classComplex__2D} results will be kept. They can then be retrieved using this method.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em index}]get best result number \char`\"{}index\char`\"{}. 0 is the best, 1 is the 2nd best etc... \item[{\em error}]\char`\"{}error\char`\"{} is filled with the metric error of the selected best result \end{description}
\end{Desc}


Definition at line 82 of file Base\-CDI.c++.

References Base\-CDI::best\_\-array, Base\-CDI::best\_\-error\_\-array, and Base\-CDI::n\_\-best.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_support@{set\_\-support}}
\index{set_support@{set\_\-support}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-support (const \bf{Double\_\-2D} \& {\em object\_\-support}, bool {\em soften} = {\tt false})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_49f77e650f9aa69e3fd5b70e3ec1378e}


Set the sample support. A \char`\"{}0\char`\"{} value in the \doxyref{Double\_\-2D}{p.}{classDouble__2D} is interpreted as being outside the support. Pixels with the maximum value of the \doxyref{Double\_\-2D}{p.}{classDouble__2D} are considered inside the support. Values between 0 and the maximum indict the soft edge of the support. In this case, when the support is applied, the esw magnitude is scaled relative to the support edge value.

By default, the edge of a given support will be softened by convolution with a 3 pixel wide gaussian. This feature can be turned off by setting the boolean flag to false.

The support can be updated at anytime during reconstruction by calling this method.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em object\_\-support}]The sample support \item[{\em soften}]If true, the edges of the support will be softened by covolving it with a 3 pixel wide gaussian. By default this option is off. \end{description}
\end{Desc}


Definition at line 95 of file Base\-CDI.c++.

References Base\-CDI::convolve(), Base\-CDI::nx, Base\-CDI::ny, and Base\-CDI::support.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_beam_stop@{set\_\-beam\_\-stop}}
\index{set_beam_stop@{set\_\-beam\_\-stop}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-beam\_\-stop (const \bf{Double\_\-2D} \& {\em beam\_\-stop\_\-region})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_9d062b4fd0397006d3238db8e3144f42}


Set the beam-stop position in the detector plane. This region will be leaf to float when the intensity if scaled during reconstruction. A zero in the array provided represents the beam stop and all other values represent the region which should be scaled.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em beam\_\-stop\_\-region}]The region of the beam stop in the detector plane \end{description}
\end{Desc}


Definition at line 109 of file Base\-CDI.c++.

References Base\-CDI::beam\_\-stop, Base\-CDI::nx, and Base\-CDI::ny.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_relaxation_parameter@{set\_\-relaxation\_\-parameter}}
\index{set_relaxation_parameter@{set\_\-relaxation\_\-parameter}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-relaxation\_\-parameter (double {\em relaxation\_\-parameter})\hspace{0.3cm}{\tt  [inline, inherited]}}\label{classBaseCDI_ae6d45b70404e602344fddadb389a3d9}


Set the relaxation parameters of the reconstruction algorithm. This is $ \beta $ used exactly as it is in Harry's review paper. This maybe reset at anytime during the reconstruction by calling this method. The default value is 0.9.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em relaxation\_\-parameter}]The algorithm relaxation\_\-parameter \end{description}
\end{Desc}


Reimplemented in \bf{Fresnel\-CDI\_\-WF} \doxyref{p.}{classFresnelCDI__WF_ae6d45b70404e602344fddadb389a3d9}.

Definition at line 261 of file Base\-CDI.h.

References Base\-CDI::algorithm, Base\-CDI::beta, and Base\-CDI::set\_\-algorithm().\index{PartialCharCDI@{Partial\-Char\-CDI}!get_size_x@{get\_\-size\_\-x}}
\index{get_size_x@{get\_\-size\_\-x}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int get\_\-size\_\-x ()\hspace{0.3cm}{\tt  [inline, inherited]}}\label{classBaseCDI_3c05b2a3360707e3dc780d9f08350e43}


\begin{Desc}
\item[Returns:]the number of pixel along the x-axis. \end{Desc}


Definition at line 270 of file Base\-CDI.h.

References Base\-CDI::nx.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_size_y@{get\_\-size\_\-y}}
\index{get_size_y@{get\_\-size\_\-y}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int get\_\-size\_\-y ()\hspace{0.3cm}{\tt  [inline, inherited]}}\label{classBaseCDI_b18b6c819f488545c03625311c1405aa}


\begin{Desc}
\item[Returns:]the number of pixel along the y-axis. \end{Desc}


Definition at line 278 of file Base\-CDI.h.

References Base\-CDI::ny.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_algorithm@{set\_\-algorithm}}
\index{set_algorithm@{set\_\-algorithm}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-algorithm (int {\em alg})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_0f38f0faa7b34f3331d5591cac58b598}


Set the algorithm. By default HIO is used.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em alg}]The algorithm. The options are: \par
 ER - error reduction \par
 BIO - basic input-output \par
 BOO - basic output-output \par
 HIO - hybrid input-output \par
 DM - difference map \par
 SF - solvent-flipping \par
 ASR - averaged successive reflections \par
 HPR - hybrid projection reflection \par
 RAAR - relaxed averaged alternating reflectors \end{description}
\end{Desc}


Reimplemented in \bf{Fresnel\-CDI\_\-WF} \doxyref{p.}{classFresnelCDI__WF_0f38f0faa7b34f3331d5591cac58b598}.

Definition at line 189 of file Base\-CDI.c++.

References Base\-CDI::algorithm, Base\-CDI::beta, and Base\-CDI::set\_\-custom\_\-algorithm().\index{PartialCharCDI@{Partial\-Char\-CDI}!set_custom_algorithm@{set\_\-custom\_\-algorithm}}
\index{set_custom_algorithm@{set\_\-custom\_\-algorithm}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-custom\_\-algorithm (double {\em m1}, double {\em m2}, double {\em m3}, double {\em m4}, double {\em m5}, double {\em m6}, double {\em m7}, double {\em m8}, double {\em m9}, double {\em m10})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_bef3f7cf18631094a2ed122e5a9902f6}


Iterative reconstruction algorithms can be expressed as a combination of the following 5 operators:\par
$ \hat{P}_S \hat{P}_F$, $\hat{P}_F \hat{P}_S$ , $ \hat{P}_S $ , $ \hat{P}_F $ and $ \hat{I} $ \par
 Where $ \hat{P}_S $ is the support projection and $ \hat{P}_F $ is the intensity projection. These can be combined to form a basis of 10 vectors (see Harray's review). The parameters to this method set the coefficient for each of these vectors. Note: the vector set is linearly dependant.

Please see page 22 of the H.M. Quiney review: TUTORIAL REVIEW, Coherent diffractive imaging using short wavelength light sources, Journal of Modern Optics, 2010, DOI: 10.1080/09500340.2010.495459

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em m1}]Coefficient to the $ [ \hat{P}_S \hat{P}_F - \hat{P}_F \hat{P}_S ]x_k $ term \item[{\em m2}]Coefficient to the $ [ \hat{P}_S \hat{P}_F - \hat{P}_F ]x_k $ term \item[{\em m3}]Coefficient to the $ [ \hat{P}_S \hat{P}_F - \hat{P}_S ]x_k $ term \item[{\em m4}]Coefficient to the $ [ \hat{P}_S \hat{P}_F - \hat{I} ]x_k $ term \item[{\em m5}]Coefficient to the $ [ \hat{P}_F \hat{P}_S - \hat{P}_F ]x_k $ term \item[{\em m6}]Coefficient to the $ [ \hat{P}_F \hat{P}_S - \hat{P}_S ]x_k $ term \item[{\em m7}]Coefficient to the $ [ \hat{P}_F \hat{P}_S - \hat{I} ]x_k $ term \item[{\em m8}]Coefficient to the $ [ \hat{P}_F - \hat{P}_S ]x_k $ term \item[{\em m9}]Coefficient to the $ [ \hat{P}_F - \hat{I} ]x_k $ term \item[{\em m10}]Coefficient to the $ [ \hat{P}_S - \hat{I} ]x_k $ term \end{description}
\end{Desc}


Reimplemented in \bf{Fresnel\-CDI\_\-WF} \doxyref{p.}{classFresnelCDI__WF_bef3f7cf18631094a2ed122e5a9902f6}.

Definition at line 237 of file Base\-CDI.c++.

References Base\-CDI::algorithm, Base\-CDI::algorithm\_\-structure, and Base\-CDI::reallocate\_\-temp\_\-complex\_\-memory().\index{PartialCharCDI@{Partial\-Char\-CDI}!print_algorithm@{print\_\-algorithm}}
\index{print_algorithm@{print\_\-algorithm}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void print\_\-algorithm ()\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_8df60e88c8f12cc220608fa620419326}


Print the current algorithm to standard output. The algorithm is in the form: \par
 $ x_{k+1} = x_k + (a \hat{P}_S \hat{P}_F + b \hat{P}_F \hat{P}_S + c \hat{P}_S + d \hat{P}_F + e \hat{I} )x_k $ 

Reimplemented in \bf{Fresnel\-CDI\_\-WF} \doxyref{p.}{classFresnelCDI__WF_8df60e88c8f12cc220608fa620419326}.

Definition at line 275 of file Base\-CDI.c++.

References Base\-CDI::algorithm, and Base\-CDI::algorithm\_\-structure.\index{PartialCharCDI@{Partial\-Char\-CDI}!get_error@{get\_\-error}}
\index{get_error@{get\_\-error}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double get\_\-error ()\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_96a694cad876c4211d68b9526ab2784b}


Get the difference between the estimated diffraction and the actual diffraction pattern. \par
 $ \chi^2 = \frac { \sum_{pixels} ( M_{pixel} - \sqrt{I_{pixel}} )^2 } { \sum_{pixels} {I_{pixel}} } $. \par
 Where $ M $ is the magnitude of the current estimate and $ I $ is the measured intensity.

NOTE: This method actually gives you the error for the previous iteration. This is because it's much faster to calculate the error during the intensity scaling step of the iteration rather than performing a FFT just for the error calculation.

\begin{Desc}
\item[Returns:]The error metric \end{Desc}


Definition at line 123 of file Base\-CDI.c++.

References Base\-CDI::current\_\-error.\index{PartialCharCDI@{Partial\-Char\-CDI}!getAlgFromName@{getAlgFromName}}
\index{getAlgFromName@{getAlgFromName}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}static int get\-Alg\-From\-Name (std::string {\em algorithm\_\-name})\hspace{0.3cm}{\tt  [inline, static, inherited]}}\label{classBaseCDI_0426fd4eb7431467169f5223e26cf0ae}


Given the name of an algorithm, e.g. \char`\"{}HIO\char`\"{}, return the unique integer identifier. This is used by the configuration file reader, and probably won't be needed by users.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em algorithm\_\-name}]The algorithm name \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]The integer identifier \end{Desc}


Definition at line 379 of file Base\-CDI.h.

References Base\-CDI::alg\-Name\-Map.\index{PartialCharCDI@{Partial\-Char\-CDI}!apply_shrinkwrap@{apply\_\-shrinkwrap}}
\index{apply_shrinkwrap@{apply\_\-shrinkwrap}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void apply\_\-shrinkwrap (double {\em gauss\_\-width} = {\tt 1.5}, double {\em threshold} = {\tt 0.1})\hspace{0.3cm}{\tt  [virtual, inherited]}}\label{classBaseCDI_7bfaaf0eb0f54efb3f2a53b9eb4e3093}


Apply the shrinkwrap algorithm. The magnitude of the current ESW estimate will be convolved with a Gaussian, thresholded and set as the new support.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em gauss\_\-width}]The width ( $ \sigma $ ) of the Gaussian in pixels. The default is 1.5. \item[{\em threshold}]The threshold which is applied, as a fraction of the maximum pixel value. The default is 0.1 (10\%). \end{description}
\end{Desc}


Definition at line 413 of file Base\-CDI.c++.

References Base\-CDI::apply\_\-threshold(), Base\-CDI::complex, Base\-CDI::convolve(), Complex\_\-2D::get\_\-2d(), MAG, Base\-CDI::nx, Base\-CDI::ny, and Base\-CDI::set\_\-support().\index{PartialCharCDI@{Partial\-Char\-CDI}!get_support@{get\_\-support}}
\index{get_support@{get\_\-support}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}const \bf{Double\_\-2D}\& get\_\-support ()\hspace{0.3cm}{\tt  [inline, inherited]}}\label{classBaseCDI_a41c63a5fa56aac6ce58b77296093020}


Get the current support. This might be useful if shrinkwrap has been applied, as it allows you to get the updated support.

\begin{Desc}
\item[Returns:]An object reference to the current support. \end{Desc}


Definition at line 405 of file Base\-CDI.h.

References Base\-CDI::support.\index{PartialCharCDI@{Partial\-Char\-CDI}!apply_support@{apply\_\-support}}
\index{apply_support@{apply\_\-support}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void apply\_\-support (\bf{Complex\_\-2D} \& {\em c})\hspace{0.3cm}{\tt  [virtual, inherited]}}\label{classBaseCDI_479c3b3c6c00d87ef7e9532cf9820364}


Apply the support constraint.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em c}]The complex field to apply the support constraint on \end{description}
\end{Desc}


Reimplemented in \bf{Fresnel\-CDI} \doxyref{p.}{classFresnelCDI_d754847bcf0151ffcc0c52682c017120}.

Definition at line 127 of file Base\-CDI.c++.

References Transmission\-Constraint::apply\_\-constraint(), Base\-CDI::support\_\-constraint(), and Base\-CDI::transmission\_\-constraint.\index{PartialCharCDI@{Partial\-Char\-CDI}!project_intensity@{project\_\-intensity}}
\index{project_intensity@{project\_\-intensity}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void project\_\-intensity (\bf{Complex\_\-2D} \& {\em c})\hspace{0.3cm}{\tt  [virtual, inherited]}}\label{classBaseCDI_27de037bc8f7e4d4d07b3084570cd11b}


Apply the intensity constraint. The ESW is projected to the detector plane, the intensity is scaled to match the measured data and the field is projected back into the sample plane.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em c}]The complex field to apply the intensity constraint on \end{description}
\end{Desc}


Definition at line 153 of file Base\-CDI.c++.

References Base\-CDI::propagate\_\-from\_\-detector(), Base\-CDI::propagate\_\-to\_\-detector(), and Base\-CDI::scale\_\-intensity().\index{PartialCharCDI@{Partial\-Char\-CDI}!set_fftw_type@{set\_\-fftw\_\-type}}
\index{set_fftw_type@{set\_\-fftw\_\-type}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void set\_\-fftw\_\-type (int {\em type})\hspace{0.3cm}{\tt  [inherited]}}\label{classBaseCDI_5bf4618dd19f4e64a78a510d6f242d35}


A flag which is used for the fast fourier transforms to select the fft algorithm. It maybe either FFTW\_\-ESTIMATE, FFTW\_\-MEASURE or FFTW\_\-PATIENT. See the fftw documentation for a description of each. By default we use FFTW\_\-MEASURE. FFTW\_\-ESTIMATE is used for testing purposes.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em type}]- FFTW\_\-ESTIMATE, FFTW\_\-MEASURE or FFTW\_\-PATIENT \end{description}
\end{Desc}


Definition at line 491 of file Base\-CDI.c++.

References Base\-CDI::complex, Complex\_\-2D::set\_\-fftw\_\-type(), Base\-CDI::temp\_\-complex\_\-PF, and Base\-CDI::temp\_\-complex\_\-PFS.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_complex_constraint@{set\_\-complex\_\-constraint}}
\index{set_complex_constraint@{set\_\-complex\_\-constraint}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}virtual void set\_\-complex\_\-constraint (\bf{Transmission\-Constraint} \& {\em trans\_\-constraint})\hspace{0.3cm}{\tt  [inline, virtual, inherited]}}\label{classBaseCDI_378db5ad6d9d75f0740aa1e172873105}


void set\_\-complex\_\-constraint\_\-function(void ($\ast$complex\_\-constraint)(\doxyref{Complex\_\-2D}{p.}{classComplex__2D} \& tranmission))\{ custom\_\-complex\_\-constraint = complex\_\-constraint; \} 

Definition at line 468 of file Base\-CDI.h.

References Base\-CDI::transmission\_\-constraint.\index{PartialCharCDI@{Partial\-Char\-CDI}!set_up_algorithm_name_map@{set\_\-up\_\-algorithm\_\-name\_\-map}}
\index{set_up_algorithm_name_map@{set\_\-up\_\-algorithm\_\-name\_\-map}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}map$<$ string, int $>$ $\ast$ set\_\-up\_\-algorithm\_\-name\_\-map ()\hspace{0.3cm}{\tt  [static, protected, inherited]}}\label{classBaseCDI_8d966dd417d8812968197d19e7cbcde7}


Sets up the mapping between algorithm name and number. This is only called during the initialisation and should not be called elsewhere.

\begin{Desc}
\item[Returns:]The algorithm name-iteger mapping \end{Desc}


Definition at line 14 of file Base\-CDI.c++.\index{PartialCharCDI@{Partial\-Char\-CDI}!apply_threshold@{apply\_\-threshold}}
\index{apply_threshold@{apply\_\-threshold}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void apply\_\-threshold (\bf{Double\_\-2D} \& {\em array}, double {\em threshold})\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_6a7a3635d41f9ae8334f0f3ea36b37cb}


Apply a threshold to the values in \char`\"{}array\char`\"{}.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em array}]The array to be thresholded \item[{\em threshold}]The threshold which is applied, as a fraction of the maximum pixel value. The default is 0.1 (10\%). \end{description}
\end{Desc}


Definition at line 474 of file Base\-CDI.c++.

References Base\-CDI::nx.\index{PartialCharCDI@{Partial\-Char\-CDI}!convolve@{convolve}}
\index{convolve@{convolve}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void convolve (\bf{Double\_\-2D} \& {\em array}, double {\em gauss\_\-width}, int {\em pixel\_\-cut\_\-off} = {\tt 4})\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_100d38fcd65938f636a4ded00bd1ba98}


Convolved \char`\"{}array\char`\"{} with a 2-D Gaussian function. To speed up computation we only convolve up to 4 pixels away from the Gaussian peak.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em array}]The array to be convolved \item[{\em gauss\_\-width}]The width ( $ \sigma $ ) of the Gaussian in pixels. The default is 1.5. \item[{\em pixel\_\-cut\_\-off}]Convolve up to 4 pixels away from the Gaussian peak. \end{description}
\end{Desc}


Definition at line 429 of file Base\-CDI.c++.

References Base\-CDI::nx, and Base\-CDI::ny.

\subsection{Field Documentation}
\index{PartialCharCDI@{Partial\-Char\-CDI}!lx@{lx}}
\index{lx@{lx}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double \bf{lx}\hspace{0.3cm}{\tt  [protected]}}\label{classPartialCharCDI_affbd34cb2ffc8b4ddb910be709c9c75}


Last calculated coherence lengths.

Note: 'coherence length' is defined as the standard deviation of the coherence function in the DETECTOR-PLANE. This means that these are the fourier transform (ie. inverse since it's gaussian) of the coherence length in the object-plane. 

Definition at line 71 of file Partial\-Char\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!complex@{complex}}
\index{complex@{complex}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Complex\_\-2D}\& \bf{complex}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_e835e888a027229f471e1d9948e614b1}


a reference to the \doxyref{Complex\_\-2D}{p.}{classComplex__2D} object which is altered during each iteration 

Definition at line 91 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!nx@{nx}}
\index{nx@{nx}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int \bf{nx}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_9515687a9dece1086de8ff1baec11196}


The samplings in x 

Definition at line 94 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!ny@{ny}}
\index{ny@{ny}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int \bf{ny}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_c00b6399ae98f2f721909222a5370f02}


The samplings in y 

Definition at line 97 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!temp_complex_PFS@{temp\_\-complex\_\-PFS}}
\index{temp_complex_PFS@{temp\_\-complex\_\-PFS}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Complex\_\-2D}$\ast$ \bf{temp\_\-complex\_\-PFS}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_1a68b43770ba0344d3e70131429595ac}


temporary Complex\_\-2Ds which are used in the computation of the PFS and PF terms for each iteration. 

Definition at line 105 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!beta@{beta}}
\index{beta@{beta}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double \bf{beta}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_176bb7d2686d3fa6877f67812e905f7b}


the relaxation parameter 

Reimplemented in \bf{Poly\-CDI} \doxyref{p.}{classPolyCDI_176bb7d2686d3fa6877f67812e905f7b}.

Definition at line 111 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!support@{support}}
\index{support@{support}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Double\_\-2D} \bf{support}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_e254fc00e9e66b321298e508d842e180}


a copy of the support 

Definition at line 114 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!intensity_sqrt@{intensity\_\-sqrt}}
\index{intensity_sqrt@{intensity\_\-sqrt}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Double\_\-2D} \bf{intensity\_\-sqrt}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_ea6f01f8d72f1f998a2c365947d7cbdc}


a copy of the square root of the intensity at the detector plane. 

Definition at line 117 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!beam_stop@{beam\_\-stop}}
\index{beam_stop@{beam\_\-stop}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Double\_\-2D}$\ast$ \bf{beam\_\-stop}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_afd1497be2d976e569e47b2fc8f1041f}


A mask of the beam-stop which is used when scaling the intensity 

Definition at line 120 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!algorithm@{algorithm}}
\index{algorithm@{algorithm}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int \bf{algorithm}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_b8e07ff9f4dadf7cb82768862906e015}


the algorithm which is being used: ER, HIO etc. 

Definition at line 123 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!algorithm_structure@{algorithm\_\-structure}}
\index{algorithm_structure@{algorithm\_\-structure}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double \bf{algorithm\_\-structure}[NTERMS]\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_dbeb5c40e7fed5cb935c2e963993c6c7}


an array which holds the structure of the algorithm. i.e. the coefficients for each term in the iteration equation. 

Definition at line 127 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!current_error@{current\_\-error}}
\index{current_error@{current\_\-error}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double \bf{current\_\-error}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_6696b5214420f280d20f210c4db49a44}


the difference between the intensity in the detector plane the current estimated intensity. 

Definition at line 131 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!n_best@{n\_\-best}}
\index{n_best@{n\_\-best}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int \bf{n\_\-best}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_ed8a735b7380cad63538be8c999a5704}


how many best estimates to store 

Definition at line 134 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!best_array@{best\_\-array}}
\index{best_array@{best\_\-array}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Complex\_\-2D}$\ast$$\ast$ \bf{best\_\-array}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_5b59179363fb7b609da4d4210955dc65}


array of the best estimates 

Definition at line 137 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!best_error_array@{best\_\-error\_\-array}}
\index{best_error_array@{best\_\-error\_\-array}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ \bf{best\_\-error\_\-array}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_68844977e38b46e5dd99920ef12222c0}


array of the error corresponding to each of the best estimates 

Definition at line 141 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!transmission_constraint@{transmission\_\-constraint}}
\index{transmission_constraint@{transmission\_\-constraint}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\bf{Transmission\-Constraint}$\ast$ \bf{transmission\_\-constraint}\hspace{0.3cm}{\tt  [protected, inherited]}}\label{classBaseCDI_f0268756963c98567bdacff7b44229c4}


a function pointer to a cumstomized complex constraint 

Definition at line 145 of file Base\-CDI.h.\index{PartialCharCDI@{Partial\-Char\-CDI}!algNameMap@{algNameMap}}
\index{algNameMap@{algNameMap}!PartialCharCDI@{Partial\-Char\-CDI}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}map$<$ string, int $>$ $\ast$ \bf{alg\-Name\-Map} = Base\-CDI::set\_\-up\_\-algorithm\_\-name\_\-map()\hspace{0.3cm}{\tt  [static, protected, inherited]}}\label{classBaseCDI_269759a649ad67cc691185b7b6b8462f}


a mapping between the algorithm name (string) and identification number 

Definition at line 149 of file Base\-CDI.h.

The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
Partial\-Char\-CDI.h\item 
Partial\-Char\-CDI.c++\end{CompactItemize}
